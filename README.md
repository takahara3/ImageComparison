# Image_Comparison
2枚の画像の差分検出パッケージ（開発途中)  

## パッケージ概要  
Canny法[Canny 1986]による特徴点検出の手法を用いて,2枚の画像を比較し差分検出を行うパッケージです．  
2枚の画像の視点が完全な同一視点でない場合でも差分を検出します．(途中段階)

## 注意点
**本パッケージは開発途中のものであり，差分検出の評価方法や矩形のサイズの決め方等はまだ不完全です．**  
よって，正確に差分を検出できない場合もあります．  
また，比較する画像のサイズによっては，処理に時間がかかる可能性があります．画像のサイズが大きい場合は，サイズを落とすことを推奨します．  
(336*252のサイズのサンプル画像を利用した場合は約2分かかりました．)  

## 開発環境
以下の環境で開発，動作確認を行なっています．
* OS
  - macOS Catalina 10.15.2
* 使用言語
  - python3
* 使用パッケージ
  - NumPy
  - OpenCV
  - Matplotlib  

画像の形式はPNG形式です．

## インストール
以下のコマンドを作業ディレクトリ内で実行し,本リポジトリをダウンロードしてください．  
python3と使用パッケージのインストールについては省略します．  
`$ git clone https://github.com/takahara3/image_comparison.git`

## 実行方法
1. imgディレクトリ内に差分検出を行いたい2つの画像を入れます．
    - 比較元の画像名:  
    `origin_image.png`
    - 比較対象の画像名:  
    `comparison_image.png`
2. 以下のコマンドを実行します　　
    - 検出結果を表示：  
    `$ python3 canny.py`
    - 検出結果を表示，保存：  
    `$ python3 canny.py -s True`  
3. 検出結果の画像を保存した場合，outディレクトリが作成され，その中に画像が保存されます．

imgディレクトリ内にサンプル用の画像が入っています．サンプル画像での実行結果を以下に示します．  
### サンプルでの実行結果  
* 比較元画像  
![origin_image](https://user-images.githubusercontent.com/49555813/70996972-527b5400-2117-11ea-8045-c8f247f46e3b.png)  
* 比較対象画像  
![comparison_image](https://user-images.githubusercontent.com/49555813/70997028-6f178c00-2117-11ea-9af9-d3e0b8af1b7a.png)  
* 差分検出結果  
![result](https://user-images.githubusercontent.com/49555813/70995552-2b6f5300-2114-11ea-8310-701fda4ac1b4.png)  

### オプション引数について  
`canny.py`を実行時に以下の引数を渡すことができます．  
  - `-s True`        :差分の検出結果を保存  
  - `-f True`        :各画像の各矩形の特徴点の数，矩形ごとの特徴点の差をグラフで表示  
  - `-n {file_name}` :保存する画像につける名前(指定しない場合`result.png`で保存される．)  
  - `-h`             :オプションのhelpを表示
